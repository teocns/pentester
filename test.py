# import subprocess
# import threading

# p = subprocess.Popen(['bash', '-c', 'docker exec -it kali bash'], stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE, shell=False)
# exit = False


# def read_stdout():
#     while not exit:
#         msg = p.stdout.readline()
#         print("stdout: ", msg.decode())
# def read_stderro():
#     while not exit:
#         msg = p.stderr.readline()
#         print("stderr: ", msg.decode())

# threading.Thread(target=read_stdout).start()
# threading.Thread(target=read_stderro).start()

# while not exit:
#     res = input(">")
#     p.stdin.write((res + '\n').encode())
#     p.stdin.flush()



import subprocess
import select

def on_output(data):
    print (data)

p = subprocess.Popen(["ls", "-l"], stdout=subprocess.PIPE, stderr=subprocess.STDOUT)

while p.poll() is None:
    rlist, _, _ = select.select([p.stdout], [], [], 0.0)
    if rlist:
        line = p.stdout.readline()
        on_output(line.rstrip())