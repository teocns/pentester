# Create a dockerfile for an image that has access to kali linux repositories
# and has xsser installed.

FROM kalilinux/kali-rolling

RUN apt-get update && \ 
    apt-get install -y xsser && \     
    apt-get install -y git && \
    apt-get install -y metasploit-framework && \
    apt-get install -y openssh-server

RUN update-rc.d postgresql enable

CMD ["sleep 10; service postgresql start"]


# RUN mkdir /var/run/sshd
# RUN echo 'root:root' | chpasswd
# RUN echo 'PermitRootLogin yes' | tee -a /etc/ssh/sshd_config

# # SSH login fix. Otherwise user is kicked off after login
# RUN sed 's@session\s*required\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d/sshd

# ENV NOTVISIBLE "in users profile"
# RUN echo "export VISIBLE=now" /etc/profile
# RUN sudo service ssh start




