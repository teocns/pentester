# Create a dockerfile for an image that has access to kali linux repositories
# and has xsser installed.

FROM kalilinux/kali-rolling

# Make the Dockerfile cache downloads from apt ;) 


RUN apt-get update && \ 
    apt-get install -y \
    openssh-server \
    metasploit-framework \
    iptables \ 
    python3 \
    python3-pip \ 
    nmap


    


WORKDIR /usr/src/app

ADD lib lib/
ADD requirements.txt .
ADD worker worker/

RUN --mount=type=cache,target=/root/.cache/pip3 pip3 install -r requirements.txt


# Uniscan dependencies
# RUN cpan install HTTP::Request && \ 
#     cpan install LWP/UserAgent.pm && \
#     cpan install LWP/Protocol/https.pm && \
#     cpan install LWP::Protocol::https

#RUN msfrpcd -P pentest_tool -n -v

#ENTRYPOINT ["/bin/bash"]

# Clone the repository https://github.com/teocns/metasploit-framework
# and install it.


# WORKDIR /opt/metasploit

# RUN git clone https://github.com/teocns/metasploit-framework .

# COPY docker/kali/database.yml config/database.yml

# RUN install


