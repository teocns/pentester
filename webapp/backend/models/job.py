
from django.db import models
from django.contrib import admin



class Job(models.Model):

    name = "Job"

    target = models.ForeignKey('Target', on_delete=models.CASCADE, related_name='_ports')

    create_stamp = models.DateTimeField(auto_now_add=True)

    name = models.CharField(max_length=255)
    
    def __str__(self) -> str: 
        return f'{self.host}'

    def enqueue(
        self
    ):
        from lib.modules.scanners.ports import PortScanner
        result = PortScanner.apply(self.host)
        for port in result['ports']:
            print("Found port open", port)

    

    
# @admin.register(Target)
# class TargetAdmin(DjangoObjectActions, admin.ModelAdmin):
#     list_display = [
#         'host',
#         'open_ports'
#     ]





#     def scan_ports(self,request,obj):
#         pass


#     def open_ports(self,obj):
#         return obj.open_ports

#     scan_ports.label = "Scan ports"
#     scan_ports.short_description = "Scan ports fast"
    
#     change_actions = ('scan_ports', )

#     actions = ('scan_ports', )

#     tools_view_name = "AAA"
