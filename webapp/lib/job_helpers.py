
from logging import log


def get_func(func_name):
    import importlib

    mod_name, func_name = func_name.rsplit('.', 1)
    mod = importlib.import_module(mod_name)
    log.info(getattr(mod, func_name))
    return getattr(mod, func_name)

def celery_enqueue(
    queue_name, func, args=None, kwargs=None, priority=0,
):
    '''
    sig_ignore_kwargs: kwargs that shouldn't matter for determining if a job
    is identical.

    at_front will place the job at the front of the queue, instead of the back

    '''

    kwargs = kwargs or {}

    func = get_func(func)

    print(f'ARGS {args} -- KWARGS {kwargs} -- PRIORITY {priority}')

    func.apply_async(args=args, queue=queue_name, priority=priority, kwargs=kwargs)

    return
