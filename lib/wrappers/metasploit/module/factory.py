import pymetasploit3.msfrpc

def make_module_cls(mtype, mname):
    """
    Returns a module object.

    Mandatory Arguments:
    - mname : the module name (e.g. 'exploits/windows/http/icecast_header')
    """
    if mtype == 'exploit':
        return pymetasploit3.msfrpc.ExploitModule
    elif mtype == 'post':
        return pymetasploit3.msfrpc.PostModule
    elif mtype == 'encoder':
        return pymetasploit3.msfrpc.EncoderModule
    elif mtype == 'auxiliary':
        return pymetasploit3.msfrpc.AuxiliaryModule
    elif mtype == 'nop':
        return pymetasploit3.msfrpc.NopModule
    elif mtype == 'payload':
        return pymetasploit3.msfrpc.PayloadModule

    raise pymetasploit3.msfrpc.MsfRpcError('Unknown module type %s not: exploit, post, encoder, auxiliary, nop, or payload' % mname)