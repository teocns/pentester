
from .console import MsfConsole
from .client import client



def get_tools_by_port(port):
    """
    Returns a list of tools that are listening on the given port.

    8   exploit/windows/postgres/postgres_payload                   2009-04-10       excellent  Yes    PostgreSQL for Microsoft Windows Payload Execution
    """

    with MsfConsole() as console:
        console.write("search port:{}".format(port))
        return console.read()


def destroy_consoles():
    for console in client.consoles.list:
        MsfConsole.destroy(console['id'])
        

